<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coronacopia</title>
  </head>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
    * {
      font-family: 'Poppins', sans-serif;
    }
    .container {
      margin: 0;
      padding: 0;
      min-height: 35vh;
      width: 100vw;
      background: linear-gradient(45deg, #ff057c 0%, #8d0b93 50%, #321575 100%);
    }
    .item-image {
      width: 360px;
      height: 240px;
      object-fit: cover;
      display: block;
      margin: -15vh auto 0 auto;
      border-radius: 4px;
      border: 10px solid white;
    }
    .striked-price {
      text-decoration: line-through;
      font-size: 28px;
      position: relative;
      top: -5px;
      color: darkgrey;
    }
    .price {
      padding-top: 0;
      font-size: 40px;
    }
    .name {
      font-size: 30px;
      text-align: center;
      margin: 10px 0 5px 0;
    }
    .text {
      width: 50vw;
      margin: 0 auto;
    }
    .text-center {
      text-align: center;
    }
    .desc {
      padding: 10px;
      font-size: 22px;
      font-weight: 500;
    }
    .left {
      font-size: 25px;
      padding: 10px;
      font-weight: 600;
      color: darkgray;
    }
    .label {
      font-size: 15px;
      text-align: center;
      color: #e30682;
      position: relative;
      left: -50px;
    }
    .btn {
      font-size: 20px;
      margin: 0 10px;
      width: 200px;
      padding: 8px 10px;
      border-radius: 100px;
      border: none;
      background-image: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
      box-shadow: 0px 4px 8px 0 rgba(0, 0, 0, 0.2);
    }
    .button-container {
      margin-top: 40px;
      display: flex;
      flex-flow: row nowrap;
      justify-content: center;
    }
  </style>
  <body>
    <%- include ('partials/header') %> <%- include ('partials/sidenav') %>
    <div class="container"></div>
    <img
      src="data:image/jpeg;base64,<%=item.image.toString('base64')%>"
      class="item-image"
    />
    <div class="text">
      <div class="name"><%= item.name %></div>
      <div class="price text-center">
        <div class="label">special price</div>
        <%= "$"+String(item.price) %> &nbsp;<span class="striked-price">
          <%= "$"+String(Math.floor( item.price*120/100)) %>
        </span>
      </div>
      <% if (user.usertype=='seller') { %>
      <div class="button-container">
        <a href="remove<%= item._id %> "
          ><button class="inline btn buy">Remove</button></a
        >
        <a href="update<%= item._id %> ">
          <button class="inline btn add">Update</button></a
        >
      </div>
      <% } else { %>
      <div class="button-container">
        <button class="inline btn buy" onclick="buy('<%= item._id%>')">
          Buy Now
        </button>

        <a href="a2c<%= item._id %> ">
          <button class="inline btn add">Add to Cart</button>
        </a>
      </div>
      <% } %>
      <div class="desc text-center"><%= item.description %></div>

      <div class="left text-center"><%= item.quantity %> Pieces left !</div>
    </div>
    <script>
      async function buy(id) {
        console.log('hello');
        let fe = await fetch('/purchase', {
          method: 'POST',
          headers: {
            'content-type': 'application/json',
          },
          body: JSON.stringify({items: id}),
        });
        console.log(fe);
        window.location.pathname = '/buyer';
      }
    </script>
    <script
      src="https://kit.fontawesome.com/c5b9bcd338.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
